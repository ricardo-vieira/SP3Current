CREATE DATABASE dbProjetos;
GO

USE dbProjetos;
GO

CREATE TABLE [dbo].[PESSOAS] (
    [ID]          BIGINT       IDENTITY (1, 1) NOT NULL,
    [NOME]        VARCHAR (50) NULL,
    [OBSERVACAO]  TEXT         NULL,
    [DATACRIACAO] DATETIME     NULL,
    [STATUS]      TINYINT      DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC)
);


GO


CREATE TABLE [dbo].[PROJETOS] (
    [ID]                      BIGINT          IDENTITY (1, 1) NOT NULL,
    [NOME]                    NVARCHAR (50)   NOT NULL,
    [DESCRICAO]               NVARCHAR (100)  NULL,
    [OBSERVACAO]              TEXT            NULL,
    [GERENTE]                 BIGINT          NOT NULL,
    [DATACRIACAO]             DATETIME        NULL,
    [INVESTIMENTOPREVISTO]    DECIMAL (15, 4) NULL,
    [RECEITACONSTANTE]        DECIMAL (15, 4) NULL,
    [RAZAORECEITAVALOR]       DECIMAL (15, 4) NULL,
    [RAZAORECEITAPERCENTUAL]  DECIMAL (7, 3)  NULL,
    [TEMPOPREVISTOCONCLUSAO]  DECIMAL (7, 3)  NULL,
    [STATUS]                  TINYINT         DEFAULT ((1)) NULL,
    [CAPACIDADEENTREGAEQUIPE] INT             NULL,
    [APOIOALTAGESTAO]         INT             NULL,
    [APOIOSTEAKHOLDERS]       INT             NULL,
    [ESFORCOADICIONAL]        INT             NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([GERENTE]) REFERENCES [dbo].[PESSOAS] ([ID])
);

GO

CREATE TABLE [dbo].[REUNIOES] (
    [ID]                     BIGINT          IDENTITY (1, 1) NOT NULL,
    [DESCRICAO]              NVARCHAR (50)   NOT NULL,
    [DATAHORAEVENTO]         DATETIME        NULL,
    [DATACRIACAO]            DATETIME        NULL,
    [PAYBACKACEITAVEL]       DECIMAL (15, 4) DEFAULT ((0)) NULL,
    [TAXAREMUNERACAOMERCADO] DECIMAL (15, 4) DEFAULT ((0)) NULL,
    [PAUTADESCRICAO]         TEXT            NULL,
    [LOCAL]                  NVARCHAR (50)   NULL,
    [RESPONSAVEL]            BIGINT          NULL,
    [AHPCALCULADO]           TINYINT         DEFAULT ((0)) NULL,
    [SITUACAO]               VARCHAR (15)    DEFAULT ('EM OPERAÇÃO') NULL,
    [TAXACUSTOCAPITAL]       DECIMAL (15, 4) DEFAULT ((0)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([RESPONSAVEL]) REFERENCES [dbo].[PESSOAS] ([ID]) ON DELETE SET NULL
);



GO

CREATE TABLE [dbo].[PAUTAPROJETOS] (
    [ID]                                     BIGINT          IDENTITY (1, 1) NOT NULL,
    [IDREUNIAO]                              BIGINT          NOT NULL,
    [IDPROJETO]                              BIGINT          NOT NULL,
    [TEMPOPREVISTOCONCLUSAO]                 DECIMAL (15, 4) NULL,
    [RECEITACONSTANTE]                       DECIMAL (15, 4) NULL,
    [RAZAORECEITAVALOR]                      DECIMAL (15, 4) NULL,
    [RAZAORECEITAPERCENTUAL]                 DECIMAL (15, 4) NULL,
    [INVESTIMENTOPREVISTO]                   DECIMAL (15, 4) NULL,
    [RESULTADOPAYBACK]                       DECIMAL (15, 4) NULL,
    [ORDEMRESULTADOPAYBACK]                  INT             NULL,
    [APROVACAORESULTADOPAYBACK]              VARCHAR (5)     NULL,
    [RESULTADOVALORPRESENTELIQUIDO]          DECIMAL (15, 4) NULL,
    [ORDEMRESULTADOVALORPRESENTELIQUIDO]     INT             NULL,
    [APROVACAORESULTADOVALORPRESENTELIQUIDO] VARCHAR (5)     NULL,
    [RESULTADOTAXAINTERNARETORNO]            DECIMAL (15, 4) NULL,
    [ORDEMRESULTADOTAXAINTERNARETORNO]       INT             NULL,
    [APROVACAORESULTADOTAXAINTERNARETORNO]   VARCHAR (5)     NULL,
    [RESULTADODICE]                          DECIMAL (15, 4) NULL,
    [ORDEMRESULTADODICE]                     INT             NULL,
    [APROVACAORESULTADODICE]                 VARCHAR (5)     NULL,
    [CAPACIDADEENTREGAEQUPE]                 INT             NULL,
    [APOIOALTAGESTAO]                        INT             NULL,
    [APOIOSTEAKHOLDERS]                      INT             NULL,
    [ESFORCOADICIONAL]                       INT             NULL,
    [RESULTADOAHP]                           DECIMAL (15, 4) NULL,
    [ORDEMRESULTADOAHP]                      INT             NULL,
    [APROVACAORESULTADOAHP]                  VARCHAR (5)     NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDREUNIAO]) REFERENCES [dbo].[REUNIOES] ([ID]) ON DELETE CASCADE,
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]) ON DELETE CASCADE
);



GO

CREATE TABLE [dbo].[PAUTARECEITAVARIAVEL] (
    [ID]             BIGINT          IDENTITY (1, 1) NOT NULL,
    [IDPAUTAPROJETO] BIGINT          NOT NULL,
    [DATAPERIODO]    DATE            NULL,
    [TIPO]           VARCHAR (10)    DEFAULT ('RECEITA') NULL,
    [DATACRIACAO]    DATETIME        NULL,
    [VALOR]          DECIMAL (15, 4) NULL,
    [STATUS]         TINYINT         DEFAULT ((1)) NULL,
    [OBSERVACOES]    TEXT            NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDPAUTAPROJETO]) REFERENCES [dbo].[PAUTAPROJETOS] ([ID]) ON DELETE CASCADE
);



GO

CREATE TABLE [dbo].[PERFILUSUARIO] (
    [ID]         BIGINT         IDENTITY (1, 1) NOT NULL,
    [NOME]       NVARCHAR (50)  NOT NULL,
    [DESCRICAO]  NVARCHAR (100) NULL,
    [DATACRICAO] DATETIME       NULL,
    [STATUS]     TINYINT        DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC)
);


GO



CREATE TABLE [dbo].[PERMISSOES] (
    [ID]           BIGINT        NOT NULL,
    [DESCRICAO]    VARCHAR (100) NOT NULL,
    [DATA_CRIACAO] DATETIME      NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([ID]) REFERENCES [dbo].[PERFILUSUARIO] ([ID]) ON DELETE CASCADE
);

GO

CREATE TABLE [dbo].[COMPETENCIAS] (
    [ID]        BIGINT       IDENTITY (1, 1) NOT NULL,
    [DESCRICAO] VARCHAR (50) NOT NULL,
    [OBSERVAO]  TEXT         NULL,
    [NIVEL]     INT          DEFAULT ((0)) NULL,
    [STATUS]    TINYINT      DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC)
);

GO

CREATE TABLE [dbo].[COMPETENCIASEXIGIDAS] (
    [IDPROJETO]     BIGINT  NOT NULL,
    [IDCOMPETENCIA] BIGINT  NOT NULL,
    [NIVEL]         INT     DEFAULT ((0)) NULL,
    [OBSERVACOES]   TEXT    NULL,
    [STATUS]        TINYINT DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([IDPROJETO] ASC, [IDCOMPETENCIA] ASC),
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]) ON DELETE CASCADE,
    FOREIGN KEY ([IDCOMPETENCIA]) REFERENCES [dbo].[COMPETENCIAS] ([ID])
);

GO


CREATE TABLE [dbo].[PESSOACOMPETENCIAS] (
    [IDPESSOA]      BIGINT  NOT NULL,
    [IDCOMPETENCIA] BIGINT  NOT NULL,
    [OBSERVACAO]    TEXT    NOT NULL,
    [STATUS]        TINYINT DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([IDPESSOA] ASC, [IDCOMPETENCIA] ASC),
    FOREIGN KEY ([IDPESSOA]) REFERENCES [dbo].[PESSOAS] ([ID]) ON DELETE CASCADE,
    FOREIGN KEY ([IDCOMPETENCIA]) REFERENCES [dbo].[COMPETENCIAS] ([ID]) ON DELETE CASCADE
);



GO









CREATE TABLE [dbo].[CRITERIOS] (
    [ID]          BIGINT   IDENTITY (1, 1) NOT NULL,
    [DESCRICAO]   TEXT     NULL,
    [STATUS]      TINYINT  DEFAULT ((1)) NULL,
    [DATACRIACAO] DATETIME NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC)
);


GO

CREATE TABLE [dbo].[CRITERIOSCOMPARACOES] (
    [ID]          INT          IDENTITY (1, 1) NOT NULL,
    [IDCRITERIOA] BIGINT       NOT NULL,
    [IDCRITERIOB] BIGINT       NOT NULL,
    [COMPARACAO]  VARCHAR (50) DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDCRITERIOA]) REFERENCES [dbo].[CRITERIOS] ([ID]),
    FOREIGN KEY ([IDCRITERIOB]) REFERENCES [dbo].[CRITERIOS] ([ID])
);

GO

CREATE TABLE [dbo].[CRITERIOSPROJETOSCOMPARACOES] (
    [ID]         BIGINT      IDENTITY (1, 1) NOT NULL,
    [IDCRITERIO] BIGINT      NOT NULL,
    [IDPROJETOA] BIGINT      NOT NULL,
    [IDPROJETOB] BIGINT      NULL,
    [COMPARACAO] VARCHAR (3) DEFAULT ('1') NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDCRITERIO]) REFERENCES [dbo].[CRITERIOS] ([ID]),
    FOREIGN KEY ([IDPROJETOA]) REFERENCES [dbo].[PROJETOS] ([ID]),
    FOREIGN KEY ([IDPROJETOB]) REFERENCES [dbo].[PROJETOS] ([ID])
);

GO

CREATE TABLE [dbo].[CRITERIOSRESULTADO] (
    [ID]                  BIGINT          IDENTITY (1, 1) NOT NULL,
    [IDCRITERIO]          BIGINT          NOT NULL,
    [DATACOMPARACAO]      DATETIME        NULL,
    [RESULTADOCOMPARACAO] DECIMAL (18, 4) NOT NULL,
    [RESULTADOGLOBAL]     DECIMAL (18, 4) NOT NULL,
    [IDREUNIAO]           BIGINT          NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDCRITERIO]) REFERENCES [dbo].[CRITERIOS] ([ID]),
    FOREIGN KEY ([IDREUNIAO]) REFERENCES [dbo].[REUNIOES] ([ID])
);


GO

CREATE TABLE [dbo].[CRITERIOSPROJETOSRESULTADO] (
    [ID]                   BIGINT          IDENTITY (1, 1) NOT NULL,
    [IDCRITERIOSRESULTADO] BIGINT          NOT NULL,
    [IDPROJETO]            BIGINT          NOT NULL,
    [DATACOMPARACAO]       DATETIME        NULL,
    [RESULTADO]            DECIMAL (18, 4) NOT NULL,
    [RESULTADOGLOBAL]      DECIMAL (18, 4) NOT NULL,
    [IDREUNIAO]            BIGINT          NOT NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]),
    FOREIGN KEY ([IDCRITERIOSRESULTADO]) REFERENCES [dbo].[CRITERIOSRESULTADO] ([ID]),
    FOREIGN KEY ([IDREUNIAO]) REFERENCES [dbo].[REUNIOES] ([ID])
);

GO


CREATE TABLE [dbo].[CRITERIOSPROJETOSRESULTADOLISTA] (
    [ID]                           BIGINT   IDENTITY (1, 1) NOT NULL,
    [IDCRITERIOSPROJETOSRESULTADO] BIGINT   NOT NULL,
    [IDPROJETO]                    BIGINT   NOT NULL,
    [COMPARACAO]                   CHAR (3) DEFAULT ('1') NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]),
    FOREIGN KEY ([IDCRITERIOSPROJETOSRESULTADO]) REFERENCES [dbo].[CRITERIOSPROJETOSRESULTADO] ([ID])
);




CREATE TABLE [dbo].[CRITERIOSRESULTADOLISTA] (
    [ID]                  BIGINT   IDENTITY (1, 1) NOT NULL,
    [IDCRITERIORESULTADO] BIGINT   NOT NULL,
    [IDCRITERIO]          BIGINT   NOT NULL,
    [COMPARACAO]          CHAR (3) DEFAULT ('1') NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDCRITERIO]) REFERENCES [dbo].[CRITERIOS] ([ID]),
    FOREIGN KEY ([IDCRITERIORESULTADO]) REFERENCES [dbo].[CRITERIOSRESULTADO] ([ID])
);



GO




CREATE TABLE [dbo].[RECEITAVARIAVEL] (
    [ID]          BIGINT          IDENTITY (1, 1) NOT NULL,
    [IDPROJETO]   BIGINT          NOT NULL,
    [DATAPERIODO] DATE            NOT NULL,
    [TIPO]        VARCHAR (10)    DEFAULT ('R') NOT NULL,
    [DATACRIACAO] DATETIME        NULL,
    [VALOR]       DECIMAL (15, 4) NULL,
    [STATUS]      TINYINT         DEFAULT ((1)) NULL,
    [OBSERVACOES] TEXT            NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]) ON DELETE CASCADE
);



GO




CREATE TABLE [dbo].[REUNIOESPARTICIPANTES] (
    [IDREUNIAO]      BIGINT  NOT NULL,
    [IDPESSOA]       BIGINT  NOT NULL,
    [OBSERVACAO]     TEXT    NULL,
    [COMPARECIMENTO] TINYINT DEFAULT ((0)) NULL,
    [STATUS]         TINYINT DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([IDREUNIAO] ASC, [IDPESSOA] ASC),
    FOREIGN KEY ([IDREUNIAO]) REFERENCES [dbo].[REUNIOES] ([ID]) ON DELETE CASCADE,
    FOREIGN KEY ([IDPESSOA]) REFERENCES [dbo].[PESSOAS] ([ID]) ON DELETE CASCADE
);


GO

CREATE TABLE [dbo].[USUARIOS] (
    [ID]            BIGINT        IDENTITY (1, 1) NOT NULL,
    [LOGIN]         NVARCHAR (20) NOT NULL,
    [PASSWORD]      NVARCHAR (32) NOT NULL,
    [PERFILUSUARIO] BIGINT        NULL,
    [DATACRICAO]    DATETIME      NULL,
    [STATUS]        TINYINT       DEFAULT ((1)) NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([PERFILUSUARIO]) REFERENCES [dbo].[PERFILUSUARIO] ([ID]) ON DELETE SET NULL
);



CREATE TABLE [dbo].[PROJETOSPESSOAS] (
    [ID]           BIGINT       IDENTITY (1, 1) NOT NULL,
    [IDPROJETO]    BIGINT       NOT NULL,
    [IDPESSOA]     BIGINT       NULL,
    [DATAINGRESSO] DATE         NULL,
    [OCUPACAO]     VARCHAR (50) NULL,
    [OBSERVACOES]  TEXT         NULL,
    PRIMARY KEY CLUSTERED ([ID] ASC),
    FOREIGN KEY ([IDPESSOA]) REFERENCES [dbo].[PESSOAS] ([ID]) ON DELETE CASCADE,
    FOREIGN KEY ([IDPROJETO]) REFERENCES [dbo].[PROJETOS] ([ID]) ON DELETE CASCADE
);











